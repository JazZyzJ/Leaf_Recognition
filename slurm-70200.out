/home/chenzijie/.local/lib/python3.10/site-packages/albumentations/check_version.py:147: UserWarning: Error fetching version info The read operation timed out
  data = fetch_version_info()
/home/chenzijie/.local/lib/python3.10/site-packages/timm/models/_factory.py:138: UserWarning: Mapping deprecated model name tf_efficientnet_b4_ns to current tf_efficientnet_b4.ns_jft_in1k.
  model = create_fn(
Starting fold 0
{"fold": 0, "epoch": 0, "train_loss": 3.287890394615373, "train_acc": 0.22457742639040348, "val_loss": 4.949459294927312, "val_acc": 0.05121220375919368, "lr": 0.0009960612933065818}
Fold 0 epoch 0: improved val acc to 0.0512
{"fold": 0, "epoch": 1, "train_loss": 2.3061817450897775, "train_acc": 0.37418211559432935, "val_loss": 4.206770457093964, "val_acc": 0.36502315445382727, "lr": 0.0009843072889837514}
Fold 0 epoch 1: improved val acc to 0.3650
{"fold": 0, "epoch": 2, "train_loss": 2.0750126919933596, "train_acc": 0.43600054525627047, "val_loss": 3.2605217776094593, "val_acc": 0.6259874693543993, "lr": 0.000964923354701182}
Fold 0 epoch 2: improved val acc to 0.6260
{"fold": 0, "epoch": 3, "train_loss": 1.8867712943218526, "train_acc": 0.46326335877862596, "val_loss": 2.3283168646075425, "val_acc": 0.7502043040043584, "lr": 0.0009382151866819102}
Fold 0 epoch 3: improved val acc to 0.7502
{"fold": 0, "epoch": 4, "train_loss": 1.7725493642730048, "train_acc": 0.48527808069792805, "val_loss": 1.562773405547624, "val_acc": 0.832470716426042, "lr": 0.0009046039886902867}
Fold 0 epoch 4: improved val acc to 0.8325
{"fold": 0, "epoch": 5, "train_loss": 1.694780443070889, "train_acc": 0.49850054525627047, "val_loss": 1.0090111597329257, "val_acc": 0.8874965949332607, "lr": 0.0008646198293969955}
Fold 0 epoch 5: improved val acc to 0.8875
{"fold": 0, "epoch": 6, "train_loss": 1.6195101381778196, "train_acc": 0.5098827699018539, "val_loss": 0.6476625422468889, "val_acc": 0.9136475074911469, "lr": 0.0008188932828794708}
Fold 0 epoch 6: improved val acc to 0.9136
{"fold": 0, "epoch": 7, "train_loss": 1.5617353470920867, "train_acc": 0.5154034896401308, "val_loss": 0.43125281785950936, "val_acc": 0.9332606919095614, "lr": 0.000768145484092009}
Fold 0 epoch 7: improved val acc to 0.9333
{"fold": 0, "epoch": 8, "train_loss": 1.517256095274194, "train_acc": 0.503680479825518, "val_loss": 0.3227004312796737, "val_acc": 0.9460637428493599, "lr": 0.0007131767561367541}
Fold 0 epoch 8: improved val acc to 0.9461
{"fold": 0, "epoch": 9, "train_loss": 1.3981496308856078, "train_acc": 0.5586150490730644, "val_loss": 0.2548585937657041, "val_acc": 0.9523290656496868, "lr": 0.0006548539886902865}
Fold 0 epoch 9: improved val acc to 0.9523
{"fold": 0, "epoch": 10, "train_loss": 1.4295327237024171, "train_acc": 0.5430752453653217, "val_loss": 0.21361806133451983, "val_acc": 0.9569599564151458, "lr": 0.0005940969666355698}
Fold 0 epoch 10: improved val acc to 0.9570
{"fold": 0, "epoch": 11, "train_loss": 1.3905108639952142, "train_acc": 0.545324427480916, "val_loss": 0.1895765159466844, "val_acc": 0.9640424952329065, "lr": 0.0005318638645048923}
Fold 0 epoch 11: improved val acc to 0.9640
{"fold": 0, "epoch": 12, "train_loss": 1.3844966041482782, "train_acc": 0.5230370774263904, "val_loss": 0.17491591724411598, "val_acc": 0.9689457913375102, "lr": 0.0004691361354951082}
Fold 0 epoch 12: improved val acc to 0.9689
{"fold": 0, "epoch": 13, "train_loss": 1.290996765589896, "train_acc": 0.5571155943293348, "val_loss": 0.16631837127904286, "val_acc": 0.9703078180332334, "lr": 0.00040690303336443076}
Fold 0 epoch 13: improved val acc to 0.9703
{"fold": 0, "epoch": 14, "train_loss": 1.2781581657338428, "train_acc": 0.5647491821155943, "val_loss": 0.16109287508645911, "val_acc": 0.9722146554072459, "lr": 0.0003461460113097141}
Fold 0 epoch 14: improved val acc to 0.9722
{"fold": 0, "epoch": 15, "train_loss": 1.2357211186100638, "train_acc": 0.5595692475463467, "val_loss": 0.15984411855479153, "val_acc": 0.9727594660855353, "lr": 0.00028782324386324637}
Fold 0 epoch 15: improved val acc to 0.9728
{"fold": 0, "epoch": 16, "train_loss": 1.2442980469768155, "train_acc": 0.530602508178844, "val_loss": 0.16057446079028787, "val_acc": 0.9738490874421138, "lr": 0.00023285451590799116}
Fold 0 epoch 16: improved val acc to 0.9738
{"fold": 0, "epoch": 17, "train_loss": 1.1797274575043661, "train_acc": 0.5779034896401308, "val_loss": 0.16174198690323893, "val_acc": 0.9743938981204031, "lr": 0.00018210671712052954}
Fold 0 epoch 17: improved val acc to 0.9744
{"fold": 0, "epoch": 18, "train_loss": 1.124922536581657, "train_acc": 0.5875817884405671, "val_loss": 0.16441484823015204, "val_acc": 0.9749387087986925, "lr": 0.0001363801706030051}
Fold 0 epoch 18: improved val acc to 0.9749
{"fold": 0, "epoch": 19, "train_loss": 1.1599089482163394, "train_acc": 0.5415076335877863, "val_loss": 0.16954000895775426, "val_acc": 0.9757559248161264, "lr": 9.639601130971386e-05}
Fold 0 epoch 19: improved val acc to 0.9758
{"fold": 0, "epoch": 20, "train_loss": 1.1408776982789992, "train_acc": 0.5768129770992366, "val_loss": 0.17430402676226558, "val_acc": 0.9763007354944157, "lr": 6.278481331809018e-05}
Fold 0 epoch 20: improved val acc to 0.9763
{"fold": 0, "epoch": 21, "train_loss": 1.1018015222630038, "train_acc": 0.6002589967284624, "val_loss": 0.1786364219764116, "val_acc": 0.976845546172705, "lr": 3.607664529881847e-05}
Fold 0 epoch 21: improved val acc to 0.9768
{"fold": 0, "epoch": 22, "train_loss": 1.1482150675556262, "train_acc": 0.5835605234460196, "val_loss": 0.18448939695406336, "val_acc": 0.9771179515118497, "lr": 1.669271101624884e-05}
Fold 0 epoch 22: improved val acc to 0.9771
{"fold": 0, "epoch": 23, "train_loss": 1.1513854216138306, "train_acc": 0.5554116684841875, "val_loss": 0.19012487937273365, "val_acc": 0.9776627621901389, "lr": 4.938706693418358e-06}
Fold 0 epoch 23: improved val acc to 0.9777
{"fold": 0, "epoch": 24, "train_loss": 1.097067597908178, "train_acc": 0.5693838604143948, "val_loss": 0.19436297462799024, "val_acc": 0.976845546172705, "lr": 1e-06}
Saved best model for fold 0 to weights/effnet_b4_baseline_fold0.pth
Starting fold 1
{"fold": 1, "epoch": 0, "train_loss": 3.2431782298155674, "train_acc": 0.2226690294438386, "val_loss": 4.945510972588564, "val_acc": 0.04957777172432579, "lr": 0.0009960612933065818}
Fold 1 epoch 0: improved val acc to 0.0496
{"fold": 1, "epoch": 1, "train_loss": 2.2589284054195606, "train_acc": 0.39960468920392583, "val_loss": 4.0860313556071555, "val_acc": 0.3726505039498774, "lr": 0.0009843072889837514}
Fold 1 epoch 1: improved val acc to 0.3727
{"fold": 1, "epoch": 2, "train_loss": 2.0026536643700097, "train_acc": 0.4520174482006543, "val_loss": 3.022326133323281, "val_acc": 0.6172704985017706, "lr": 0.000964923354701182}
Fold 1 epoch 2: improved val acc to 0.6173
{"fold": 1, "epoch": 3, "train_loss": 1.8639539758407693, "train_acc": 0.44765539803707743, "val_loss": 2.1262043722641626, "val_acc": 0.7393080904385726, "lr": 0.0009382151866819102}
Fold 1 epoch 3: improved val acc to 0.7393
{"fold": 1, "epoch": 4, "train_loss": 1.774361395068881, "train_acc": 0.49168484187568157, "val_loss": 1.437151681918989, "val_acc": 0.8153091800599291, "lr": 0.0009046039886902867}
Fold 1 epoch 4: improved val acc to 0.8153
{"fold": 1, "epoch": 5, "train_loss": 1.709192750108151, "train_acc": 0.4775081788440567, "val_loss": 0.948846871117031, "val_acc": 0.8736039226368837, "lr": 0.0008646198293969955}
Fold 1 epoch 5: improved val acc to 0.8736
{"fold": 1, "epoch": 6, "train_loss": 1.609898995222156, "train_acc": 0.509814612868048, "val_loss": 0.6290790892140932, "val_acc": 0.9081994007082539, "lr": 0.0008188932828794708}
Fold 1 epoch 6: improved val acc to 0.9082
{"fold": 1, "epoch": 7, "train_loss": 1.5448202633805728, "train_acc": 0.5283533260632497, "val_loss": 0.43948647007244673, "val_acc": 0.9302642331789703, "lr": 0.000768145484092009}
Fold 1 epoch 7: improved val acc to 0.9303
{"fold": 1, "epoch": 8, "train_loss": 1.5067922126505862, "train_acc": 0.510428026172301, "val_loss": 0.3214013621401832, "val_acc": 0.9457913375102152, "lr": 0.0007131767561367541}
Fold 1 epoch 8: improved val acc to 0.9458
{"fold": 1, "epoch": 9, "train_loss": 1.4677032838730932, "train_acc": 0.5370092693565977, "val_loss": 0.25135444273532365, "val_acc": 0.9577771724325796, "lr": 0.0006548539886902865}
Fold 1 epoch 9: improved val acc to 0.9578
{"fold": 1, "epoch": 10, "train_loss": 1.4284758604859837, "train_acc": 0.5495501635768811, "val_loss": 0.2089649475755759, "val_acc": 0.9648597112503405, "lr": 0.0005940969666355698}
Fold 1 epoch 10: improved val acc to 0.9649
{"fold": 1, "epoch": 11, "train_loss": 1.3732946743231953, "train_acc": 0.5526172300981461, "val_loss": 0.18444259474482727, "val_acc": 0.9651321165894852, "lr": 0.0005318638645048923}
Fold 1 epoch 11: improved val acc to 0.9651
{"fold": 1, "epoch": 12, "train_loss": 1.3546400000640844, "train_acc": 0.5393947655398037, "val_loss": 0.16912552943690146, "val_acc": 0.9678561699809316, "lr": 0.0004691361354951082}
Fold 1 epoch 12: improved val acc to 0.9679
{"fold": 1, "epoch": 13, "train_loss": 1.363975453045272, "train_acc": 0.5530943293347873, "val_loss": 0.1595503858343128, "val_acc": 0.9692181966766549, "lr": 0.00040690303336443076}
Fold 1 epoch 13: improved val acc to 0.9692
{"fold": 1, "epoch": 14, "train_loss": 1.2565958436533824, "train_acc": 0.569860959651036, "val_loss": 0.15524100648044922, "val_acc": 0.9703078180332334, "lr": 0.0003461460113097141}
Fold 1 epoch 14: improved val acc to 0.9703
{"fold": 1, "epoch": 15, "train_loss": 1.2907444179188075, "train_acc": 0.5258996728462377, "val_loss": 0.15381125997608866, "val_acc": 0.9733042767638246, "lr": 0.00028782324386324637}
Fold 1 epoch 15: improved val acc to 0.9733
{"fold": 1, "epoch": 16, "train_loss": 1.2420393169056239, "train_acc": 0.5647491821155943, "val_loss": 0.15406388266393126, "val_acc": 0.9749387087986925, "lr": 0.00023285451590799116}
Fold 1 epoch 16: improved val acc to 0.9749
{"fold": 1, "epoch": 17, "train_loss": 1.1883814943915756, "train_acc": 0.5621592148309705, "val_loss": 0.1557183040626138, "val_acc": 0.9757559248161264, "lr": 0.00018210671712052954}
Fold 1 epoch 17: improved val acc to 0.9758
{"fold": 1, "epoch": 18, "train_loss": 1.1992384056228589, "train_acc": 0.5604552889858233, "val_loss": 0.1589737445424539, "val_acc": 0.9765731408335603, "lr": 0.0001363801706030051}
Fold 1 epoch 18: improved val acc to 0.9766
{"fold": 1, "epoch": 19, "train_loss": 1.1515932556002064, "train_acc": 0.5672709923664122, "val_loss": 0.16388575304669992, "val_acc": 0.976845546172705, "lr": 9.639601130971386e-05}
Fold 1 epoch 19: improved val acc to 0.9768
{"fold": 1, "epoch": 20, "train_loss": 1.095489354956501, "train_acc": 0.5734051254089422, "val_loss": 0.1687852046821592, "val_acc": 0.9776627621901389, "lr": 6.278481331809018e-05}
Fold 1 epoch 20: improved val acc to 0.9777
{"fold": 1, "epoch": 21, "train_loss": 1.1453838770886153, "train_acc": 0.5852644492911668, "val_loss": 0.17464855959518702, "val_acc": 0.9776627621901389, "lr": 3.607664529881847e-05}
{"fold": 1, "epoch": 22, "train_loss": 1.1268332820617255, "train_acc": 0.5819247546346783, "val_loss": 0.18058892766694157, "val_acc": 0.9782075728684282, "lr": 1.669271101624884e-05}
Fold 1 epoch 22: improved val acc to 0.9782
{"fold": 1, "epoch": 23, "train_loss": 1.1514339185398044, "train_acc": 0.5476417666303163, "val_loss": 0.1873080252472629, "val_acc": 0.9784799782075728, "lr": 4.938706693418358e-06}
Fold 1 epoch 23: improved val acc to 0.9785
{"fold": 1, "epoch": 24, "train_loss": 1.145989724600458, "train_acc": 0.5744274809160306, "val_loss": 0.19367150519904763, "val_acc": 0.9787523835467176, "lr": 1e-06}
Fold 1 epoch 24: improved val acc to 0.9788
Saved best model for fold 1 to weights/effnet_b4_baseline_fold1.pth
Starting fold 2
{"fold": 2, "epoch": 0, "train_loss": 3.313860471532025, "train_acc": 0.2069247546346783, "val_loss": 4.990101290541492, "val_acc": 0.03840915281939526, "lr": 0.0009960612933065818}
Fold 2 epoch 0: improved val acc to 0.0384
{"fold": 2, "epoch": 1, "train_loss": 2.2772402232319866, "train_acc": 0.3894492911668484, "val_loss": 4.28565008118769, "val_acc": 0.313538545355489, "lr": 0.0009843072889837514}
Fold 2 epoch 1: improved val acc to 0.3135
{"fold": 2, "epoch": 2, "train_loss": 2.063541297369201, "train_acc": 0.4380452562704471, "val_loss": 3.2461195177162936, "val_acc": 0.574502860256061, "lr": 0.000964923354701182}
Fold 2 epoch 2: improved val acc to 0.5745
{"fold": 2, "epoch": 3, "train_loss": 1.8396983352066256, "train_acc": 0.4732824427480916, "val_loss": 2.2704178334841187, "val_acc": 0.7273222555162081, "lr": 0.0009382151866819102}
Fold 2 epoch 3: improved val acc to 0.7273
{"fold": 2, "epoch": 4, "train_loss": 1.7211284270853358, "train_acc": 0.49202562704471103, "val_loss": 1.4796827404156785, "val_acc": 0.8281122309997276, "lr": 0.0009046039886902867}
Fold 2 epoch 4: improved val acc to 0.8281
{"fold": 2, "epoch": 5, "train_loss": 1.672957607808004, "train_acc": 0.5032033805888768, "val_loss": 0.9309836578154818, "val_acc": 0.8874965949332607, "lr": 0.0008646198293969955}
Fold 2 epoch 5: improved val acc to 0.8875
{"fold": 2, "epoch": 6, "train_loss": 1.6312519087006248, "train_acc": 0.5091330425299891, "val_loss": 0.5982279859034705, "val_acc": 0.9180059929174612, "lr": 0.0008188932828794708}
Fold 2 epoch 6: improved val acc to 0.9180
{"fold": 2, "epoch": 7, "train_loss": 1.5534088096805851, "train_acc": 0.5139040348964014, "val_loss": 0.4096455479619679, "val_acc": 0.9340779079269954, "lr": 0.000768145484092009}
Fold 2 epoch 7: improved val acc to 0.9341
{"fold": 2, "epoch": 8, "train_loss": 1.4982433675289675, "train_acc": 0.5123364231188658, "val_loss": 0.3065793329194793, "val_acc": 0.9460637428493599, "lr": 0.0007131767561367541}
Fold 2 epoch 8: improved val acc to 0.9461
{"fold": 2, "epoch": 9, "train_loss": 1.4326251722474135, "train_acc": 0.5469601962922573, "val_loss": 0.24399549230523215, "val_acc": 0.9512394442931081, "lr": 0.0006548539886902865}
Fold 2 epoch 9: improved val acc to 0.9512
{"fold": 2, "epoch": 10, "train_loss": 1.4262654627942466, "train_acc": 0.5411668484187568, "val_loss": 0.2070767494373671, "val_acc": 0.9588667937891583, "lr": 0.0005940969666355698}
Fold 2 epoch 10: improved val acc to 0.9589
{"fold": 2, "epoch": 11, "train_loss": 1.3431263108419877, "train_acc": 0.5498909487459106, "val_loss": 0.18239055570287036, "val_acc": 0.9645873059111959, "lr": 0.0005318638645048923}
Fold 2 epoch 11: improved val acc to 0.9646
{"fold": 2, "epoch": 12, "train_loss": 1.3591076016686086, "train_acc": 0.5290348964013086, "val_loss": 0.16673257212463824, "val_acc": 0.9673113593026423, "lr": 0.0004691361354951082}
Fold 2 epoch 12: improved val acc to 0.9673
{"fold": 2, "epoch": 13, "train_loss": 1.3349193713852208, "train_acc": 0.5378953107960741, "val_loss": 0.1587791397124407, "val_acc": 0.9705802233723781, "lr": 0.00040690303336443076}
Fold 2 epoch 13: improved val acc to 0.9706
{"fold": 2, "epoch": 14, "train_loss": 1.2526969217097097, "train_acc": 0.5617502726281353, "val_loss": 0.1539391181821136, "val_acc": 0.9741214927812585, "lr": 0.0003461460113097141}
Fold 2 epoch 14: improved val acc to 0.9741
{"fold": 2, "epoch": 15, "train_loss": 1.2677197866832417, "train_acc": 0.5676117775354417, "val_loss": 0.1527043581759855, "val_acc": 0.9757559248161264, "lr": 0.00028782324386324637}
Fold 2 epoch 15: improved val acc to 0.9758
{"fold": 2, "epoch": 16, "train_loss": 1.2349119272850853, "train_acc": 0.5544574700109052, "val_loss": 0.15314173134405584, "val_acc": 0.9773903568509943, "lr": 0.00023285451590799116}
Fold 2 epoch 16: improved val acc to 0.9774
{"fold": 2, "epoch": 17, "train_loss": 1.1822568382600662, "train_acc": 0.5813113413304253, "val_loss": 0.1554224649852675, "val_acc": 0.9779351675292836, "lr": 0.00018210671712052954}
Fold 2 epoch 17: improved val acc to 0.9779
{"fold": 2, "epoch": 18, "train_loss": 1.1626342958816396, "train_acc": 0.5755179934569248, "val_loss": 0.15867986998289166, "val_acc": 0.9779351675292836, "lr": 0.0001363801706030051}
{"fold": 2, "epoch": 19, "train_loss": 1.1488496743410728, "train_acc": 0.5629770992366412, "val_loss": 0.16334083965958968, "val_acc": 0.9782075728684282, "lr": 9.639601130971386e-05}
Fold 2 epoch 19: improved val acc to 0.9782
{"fold": 2, "epoch": 20, "train_loss": 1.1348910561499705, "train_acc": 0.5523446019629226, "val_loss": 0.1683113173348512, "val_acc": 0.9782075728684282, "lr": 6.278481331809018e-05}
{"fold": 2, "epoch": 21, "train_loss": 1.1264417076253839, "train_acc": 0.5740185387131952, "val_loss": 0.17415316301027328, "val_acc": 0.9776627621901389, "lr": 3.607664529881847e-05}
{"fold": 2, "epoch": 22, "train_loss": 1.1099277619382157, "train_acc": 0.5871728462377317, "val_loss": 0.17949942557039197, "val_acc": 0.9779351675292836, "lr": 1.669271101624884e-05}
{"fold": 2, "epoch": 23, "train_loss": 1.1320273433867822, "train_acc": 0.5768129770992366, "val_loss": 0.1862058018495815, "val_acc": 0.9779351675292836, "lr": 4.938706693418358e-06}
{"fold": 2, "epoch": 24, "train_loss": 1.1441154353556222, "train_acc": 0.5466875681570338, "val_loss": 0.19289672579712713, "val_acc": 0.976845546172705, "lr": 1e-06}
Saved best model for fold 2 to weights/effnet_b4_baseline_fold2.pth
Starting fold 3
{"fold": 3, "epoch": 0, "train_loss": 3.3730774928075276, "train_acc": 0.1966330425299891, "val_loss": 4.992584467064132, "val_acc": 0.03487738419618529, "lr": 0.0009960612933065818}
Fold 3 epoch 0: improved val acc to 0.0349
{"fold": 3, "epoch": 1, "train_loss": 2.337525540180789, "train_acc": 0.38883587786259544, "val_loss": 4.221585451224844, "val_acc": 0.28310626702997277, "lr": 0.0009843072889837514}
Fold 3 epoch 1: improved val acc to 0.2831
{"fold": 3, "epoch": 2, "train_loss": 2.056361104110855, "train_acc": 0.419711014176663, "val_loss": 3.19704257603887, "val_acc": 0.5525885558583107, "lr": 0.000964923354701182}
Fold 3 epoch 2: improved val acc to 0.5526
{"fold": 3, "epoch": 3, "train_loss": 1.8425484358809376, "train_acc": 0.46155943293347873, "val_loss": 2.2627706662835476, "val_acc": 0.7103542234332425, "lr": 0.0009382151866819102}
Fold 3 epoch 3: improved val acc to 0.7104
{"fold": 3, "epoch": 4, "train_loss": 1.7906560085981986, "train_acc": 0.4967284623773173, "val_loss": 1.4929172707513503, "val_acc": 0.8040871934604905, "lr": 0.0009046039886902867}
Fold 3 epoch 4: improved val acc to 0.8041
{"fold": 3, "epoch": 5, "train_loss": 1.6836277926371168, "train_acc": 0.5062704471101418, "val_loss": 0.9574841203416725, "val_acc": 0.8656675749318801, "lr": 0.0008646198293969955}
Fold 3 epoch 5: improved val acc to 0.8657
{"fold": 3, "epoch": 6, "train_loss": 1.6117521496479488, "train_acc": 0.5175163576881134, "val_loss": 0.6240108392219128, "val_acc": 0.9065395095367847, "lr": 0.0008188932828794708}
Fold 3 epoch 6: improved val acc to 0.9065
{"fold": 3, "epoch": 7, "train_loss": 1.5880955854185015, "train_acc": 0.5142448200654307, "val_loss": 0.43611440600101564, "val_acc": 0.9283378746594005, "lr": 0.000768145484092009}
Fold 3 epoch 7: improved val acc to 0.9283
{"fold": 3, "epoch": 8, "train_loss": 1.5104143851585972, "train_acc": 0.5411668484187568, "val_loss": 0.32534103174300544, "val_acc": 0.9427792915531336, "lr": 0.0007131767561367541}
Fold 3 epoch 8: improved val acc to 0.9428
{"fold": 3, "epoch": 9, "train_loss": 1.428738697859557, "train_acc": 0.5654307524536533, "val_loss": 0.25677056145278243, "val_acc": 0.9514986376021798, "lr": 0.0006548539886902865}
Fold 3 epoch 9: improved val acc to 0.9515
{"fold": 3, "epoch": 10, "train_loss": 1.4031918052108623, "train_acc": 0.5435523446019629, "val_loss": 0.21029682364061028, "val_acc": 0.9574931880108992, "lr": 0.0005940969666355698}
Fold 3 epoch 10: improved val acc to 0.9575
{"fold": 3, "epoch": 11, "train_loss": 1.4024558611368536, "train_acc": 0.5194247546346783, "val_loss": 0.18223689279699196, "val_acc": 0.9645776566757494, "lr": 0.0005318638645048923}
Fold 3 epoch 11: improved val acc to 0.9646
{"fold": 3, "epoch": 12, "train_loss": 1.3142323202109258, "train_acc": 0.5463467829880043, "val_loss": 0.16468978188018382, "val_acc": 0.9683923705722071, "lr": 0.0004691361354951082}
Fold 3 epoch 12: improved val acc to 0.9684
{"fold": 3, "epoch": 13, "train_loss": 1.2964280913934323, "train_acc": 0.5517311886586695, "val_loss": 0.15562390535663845, "val_acc": 0.9711171662125341, "lr": 0.00040690303336443076}
Fold 3 epoch 13: improved val acc to 0.9711
{"fold": 3, "epoch": 14, "train_loss": 1.2650959995151736, "train_acc": 0.5599781897491821, "val_loss": 0.15118889894732337, "val_acc": 0.9730245231607629, "lr": 0.0003461460113097141}
Fold 3 epoch 14: improved val acc to 0.9730
{"fold": 3, "epoch": 15, "train_loss": 1.2217980041173708, "train_acc": 0.5811750272628136, "val_loss": 0.15000148743634653, "val_acc": 0.9741144414168937, "lr": 0.00028782324386324637}
Fold 3 epoch 15: improved val acc to 0.9741
{"fold": 3, "epoch": 16, "train_loss": 1.2558279769046226, "train_acc": 0.5618184296619411, "val_loss": 0.1522093600814284, "val_acc": 0.9732970027247957, "lr": 0.00023285451590799116}
{"fold": 3, "epoch": 17, "train_loss": 1.205861199090629, "train_acc": 0.590035441657579, "val_loss": 0.1556551735066588, "val_acc": 0.9730245231607629, "lr": 0.00018210671712052954}
{"fold": 3, "epoch": 18, "train_loss": 1.1791932191557557, "train_acc": 0.586354961832061, "val_loss": 0.15909079871970236, "val_acc": 0.9732970027247957, "lr": 0.0001363801706030051}
{"fold": 3, "epoch": 19, "train_loss": 1.1770702894602374, "train_acc": 0.5822655398037078, "val_loss": 0.16389306066633894, "val_acc": 0.9749318801089918, "lr": 9.639601130971386e-05}
Fold 3 epoch 19: improved val acc to 0.9749
{"fold": 3, "epoch": 20, "train_loss": 1.1371390236503036, "train_acc": 0.5671346782988005, "val_loss": 0.1692757837210429, "val_acc": 0.9762942779291554, "lr": 6.278481331809018e-05}
Fold 3 epoch 20: improved val acc to 0.9763
{"fold": 3, "epoch": 21, "train_loss": 1.1531580701844122, "train_acc": 0.5860823336968375, "val_loss": 0.17551786207698022, "val_acc": 0.9762942779291554, "lr": 3.607664529881847e-05}
{"fold": 3, "epoch": 22, "train_loss": 1.1345187493862996, "train_acc": 0.5659760087241004, "val_loss": 0.18206478099894458, "val_acc": 0.9762942779291554, "lr": 1.669271101624884e-05}
{"fold": 3, "epoch": 23, "train_loss": 1.1099649039518613, "train_acc": 0.5614776444929117, "val_loss": 0.18800844402339217, "val_acc": 0.9762942779291554, "lr": 4.938706693418358e-06}
{"fold": 3, "epoch": 24, "train_loss": 1.1281084064048925, "train_acc": 0.5610005452562704, "val_loss": 0.19366212549748799, "val_acc": 0.976566757493188, "lr": 1e-06}
Fold 3 epoch 24: improved val acc to 0.9766
Saved best model for fold 3 to weights/effnet_b4_baseline_fold3.pth
Starting fold 4
{"fold": 4, "epoch": 0, "train_loss": 3.281305720787922, "train_acc": 0.21428571428571427, "val_loss": 4.91162967422028, "val_acc": 0.04904632152588556, "lr": 0.0009960612933065818}
Fold 4 epoch 0: improved val acc to 0.0490
{"fold": 4, "epoch": 1, "train_loss": 2.3131278821530232, "train_acc": 0.3767039258451472, "val_loss": 4.060173908696187, "val_acc": 0.3806539509536785, "lr": 0.0009843072889837514}
Fold 4 epoch 1: improved val acc to 0.3807
{"fold": 4, "epoch": 2, "train_loss": 2.0549414317766477, "train_acc": 0.4206652126499455, "val_loss": 3.011636626558018, "val_acc": 0.6040871934604904, "lr": 0.000964923354701182}
Fold 4 epoch 2: improved val acc to 0.6041
{"fold": 4, "epoch": 3, "train_loss": 1.9028850095742662, "train_acc": 0.4599236641221374, "val_loss": 2.1678300685388843, "val_acc": 0.728882833787466, "lr": 0.0009382151866819102}
Fold 4 epoch 3: improved val acc to 0.7289
{"fold": 4, "epoch": 4, "train_loss": 1.742695457477736, "train_acc": 0.4893675027262814, "val_loss": 1.4932486167720618, "val_acc": 0.8065395095367848, "lr": 0.0009046039886902867}
Fold 4 epoch 4: improved val acc to 0.8065
{"fold": 4, "epoch": 5, "train_loss": 1.679844936796727, "train_acc": 0.492639040348964, "val_loss": 0.9981440964121909, "val_acc": 0.8610354223433242, "lr": 0.0008646198293969955}
Fold 4 epoch 5: improved val acc to 0.8610
{"fold": 4, "epoch": 6, "train_loss": 1.6303846897189724, "train_acc": 0.5174482006543075, "val_loss": 0.6587187579119888, "val_acc": 0.9024523160762943, "lr": 0.0008188932828794708}
Fold 4 epoch 6: improved val acc to 0.9025
{"fold": 4, "epoch": 7, "train_loss": 1.5361507582430491, "train_acc": 0.5194247546346783, "val_loss": 0.45219437626142267, "val_acc": 0.9291553133514986, "lr": 0.000768145484092009}
Fold 4 epoch 7: improved val acc to 0.9292
{"fold": 4, "epoch": 8, "train_loss": 1.4710286247301259, "train_acc": 0.5393266085059978, "val_loss": 0.3284998336913475, "val_acc": 0.9430517711171662, "lr": 0.0007131767561367541}
Fold 4 epoch 8: improved val acc to 0.9431
{"fold": 4, "epoch": 9, "train_loss": 1.4833731629206284, "train_acc": 0.5277399127589967, "val_loss": 0.25733490993525093, "val_acc": 0.9517711171662125, "lr": 0.0006548539886902865}
Fold 4 epoch 9: improved val acc to 0.9518
{"fold": 4, "epoch": 10, "train_loss": 1.4483240958518524, "train_acc": 0.5331243184296619, "val_loss": 0.21788754441676414, "val_acc": 0.9553133514986376, "lr": 0.0005940969666355698}
Fold 4 epoch 10: improved val acc to 0.9553
{"fold": 4, "epoch": 11, "train_loss": 1.398812834933124, "train_acc": 0.523923118865867, "val_loss": 0.1940938977397755, "val_acc": 0.9591280653950953, "lr": 0.0005318638645048923}
Fold 4 epoch 11: improved val acc to 0.9591
{"fold": 4, "epoch": 12, "train_loss": 1.3543278939266372, "train_acc": 0.556434023991276, "val_loss": 0.18086576307908067, "val_acc": 0.9623978201634877, "lr": 0.0004691361354951082}
Fold 4 epoch 12: improved val acc to 0.9624
{"fold": 4, "epoch": 13, "train_loss": 1.301577508839552, "train_acc": 0.5562295528898582, "val_loss": 0.1725388033960106, "val_acc": 0.9645776566757494, "lr": 0.00040690303336443076}
Fold 4 epoch 13: improved val acc to 0.9646
{"fold": 4, "epoch": 14, "train_loss": 1.2630121279893811, "train_acc": 0.545324427480916, "val_loss": 0.16921394350824304, "val_acc": 0.967574931880109, "lr": 0.0003461460113097141}
Fold 4 epoch 14: improved val acc to 0.9676
{"fold": 4, "epoch": 15, "train_loss": 1.236262986613204, "train_acc": 0.5713604143947656, "val_loss": 0.16847359785754285, "val_acc": 0.9689373297002725, "lr": 0.00028782324386324637}
Fold 4 epoch 15: improved val acc to 0.9689
{"fold": 4, "epoch": 16, "train_loss": 1.2372980001123548, "train_acc": 0.5641357688113413, "val_loss": 0.1707000357578496, "val_acc": 0.9697547683923706, "lr": 0.00023285451590799116}
Fold 4 epoch 16: improved val acc to 0.9698
{"fold": 4, "epoch": 17, "train_loss": 1.1827131033333724, "train_acc": 0.5793347873500545, "val_loss": 0.1717989163559529, "val_acc": 0.9708446866485013, "lr": 0.00018210671712052954}
Fold 4 epoch 17: improved val acc to 0.9708
{"fold": 4, "epoch": 18, "train_loss": 1.1890010489242286, "train_acc": 0.5808342420937841, "val_loss": 0.17522142717477737, "val_acc": 0.9705722070844687, "lr": 0.0001363801706030051}
{"fold": 4, "epoch": 19, "train_loss": 1.1507597129828537, "train_acc": 0.5875136314067612, "val_loss": 0.17863563221628076, "val_acc": 0.9705722070844687, "lr": 9.639601130971386e-05}
{"fold": 4, "epoch": 20, "train_loss": 1.1609699399156685, "train_acc": 0.5761995637949836, "val_loss": 0.1842048855341098, "val_acc": 0.9722070844686649, "lr": 6.278481331809018e-05}
Fold 4 epoch 20: improved val acc to 0.9722
{"fold": 4, "epoch": 21, "train_loss": 1.1596038647345395, "train_acc": 0.5555479825517994, "val_loss": 0.19010814477458637, "val_acc": 0.9724795640326975, "lr": 3.607664529881847e-05}
Fold 4 epoch 21: improved val acc to 0.9725
{"fold": 4, "epoch": 22, "train_loss": 1.0916476653992415, "train_acc": 0.5642039258451472, "val_loss": 0.1944008526628284, "val_acc": 0.9724795640326975, "lr": 1.669271101624884e-05}
{"fold": 4, "epoch": 23, "train_loss": 1.137076334123913, "train_acc": 0.5648854961832062, "val_loss": 0.19957484023122762, "val_acc": 0.9724795640326975, "lr": 4.938706693418358e-06}
{"fold": 4, "epoch": 24, "train_loss": 1.1187392329246684, "train_acc": 0.5881952017448201, "val_loss": 0.20447283442403705, "val_acc": 0.9724795640326975, "lr": 1e-06}
Saved best model for fold 4 to weights/effnet_b4_baseline_fold4.pth
Saved OOF predictions to oof/effnet_b4_baseline_oof.npy
CV Accuracy: 0.9767
